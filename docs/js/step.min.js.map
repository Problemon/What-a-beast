{"version":3,"sources":["step.js"],"names":["DATA","showEndGame","backToElections","addClassHidden","removeClassHidden","hideOptions","playSoundBubble","buttonNext","document","querySelector","buttonBack","indexStep","renderStepAnswer","image","indexImage","numbers","isRounded","renderStepAnswers","dataStep","images","map","join","renderStep","title","renderStepsOfLevel","levelIndex","STEPS","number","steps","level","rightAnswers","givenRightAnswers","getCurrentStep","this","querySelectorAll","getDataOfAnswer","element","closest","src","currentStep","textContent","getCheckedAnswer","stepList","checkAnswer","givenAnswerOfStep","Number","value","dataOfAnswer","push","onStepListChange","classList","remove","clearStepListChange","removeEventListener","hideCurrentStep","checkedAnswer","checked","add","showCurrentStep","addEventListener","onButtonNextClick","length","onButtonBackClick"],"mappings":"OAASA,SAAY,uBACZC,gBAAmB,sBACnBC,oBAAuB,4BACvBC,eAAgBC,sBAAyB,uBACzCC,gBAAmB,0BACnBC,oBAAuB,iBAEhC,MAAMC,WAAaC,SAASC,cAAc,0BACpCC,WAAaF,SAASC,cAAc,0BAE1C,IAAIE,UAAY,EAEhB,MAAMC,iBAAmB,CAACC,EAAOC,EAAYC,EAASC,IAAc,sGAECF,EAAa,YAAYC,EAAQ,MAAMA,EAAQ,wDAElFF,wBAA4BA,iDAC9BG,EAAY,uBAAyB,sBAAsBH,4BAAgCA,0IAMrHI,kBAAoB,CAACC,EAAUH,KACnC,MAAMI,OAACA,EAAMH,UAAEA,GAAaE,EAG5B,MAAO,8CAFeC,EAAOC,KAAI,CAACP,EAAOC,IAAeF,iBAAiBC,EAAOC,EAAYC,EAASC,KAIjFK,KAAK,8BAKrBC,WAAa,CAACJ,EAAUH,KAC5B,MAAMQ,MAACA,GAASL,EAEhB,MAAO,wKAG2CK,oCAE1CN,kBAAkBC,EAAUH,qBAKhCS,mBAAsBC,GACLzB,KAAK0B,MAAMD,GACZL,KAAI,CAACF,EAAUS,IAAWL,WAAWJ,EAAU,CAACO,EAAYE,MAG5EC,MAAQ,CACZC,MAAO,KACPC,aAAc,KACdC,kBAAmB,KAEnBC,iBAEE,OADAC,KAAKL,MAAQK,KAAKJ,MAAMK,iBAAiB,SAClCD,KAAKL,MAAMjB,YAGpBwB,gBAAgBC,GASd,MALmB,CACjBvB,MAJeuB,EAAQC,QAAQ,eACC5B,cAAc,gBAAgB6B,IAI9Df,MAHoBU,KAAKM,YAAY9B,cAAc,gBAAgB+B,cASvEC,mBACE,OAAOR,KAAKS,SAASjC,cAAc,kBAGrCkC,cACEV,KAAKW,kBAAoBX,KAAKQ,mBAI9B,GAH0BR,KAAKH,aAAanB,aACbkC,OAAOZ,KAAKW,kBAAkBE,OAEX,CAChD,MAAMC,EAAed,KAAKE,gBAAgBF,KAAKW,mBAC/CX,KAAKF,kBAAkBiB,KAAKD,KAIhCE,mBACE1C,WAAW2C,UAAUC,OAAO,kBAC5B7C,mBAGF8C,sBACEnB,KAAKS,SAASW,oBAAoB,SAAUpB,KAAKgB,mBAGnDK,kBACE,MAAMC,EAAgBtB,KAAKQ,mBAExBc,IACDA,EAAcC,SAAU,GAG1BjD,WAAW2C,UAAUO,IAAI,kBAEzBxB,KAAKmB,sBACLjD,eAAe8B,KAAKM,cAGtBmB,kBACEzB,KAAKM,YAAcN,KAAKD,iBACxBC,KAAKS,SAAWT,KAAKM,YAAY9B,cAAc,eAE/CL,kBAAkB6B,KAAKM,aACvBN,KAAKS,SAASiB,iBAAiB,SAAU1B,KAAKgB,oBAI5CW,kBAAoB,KACxBhC,MAAMe,cAEFhC,YAAciB,MAAMA,MAAMiC,OAAS,GACrCxD,cACAuB,MAAM0B,kBACNrD,YAAY2B,MAAMG,mBAClBpB,UAAY,IAEZiB,MAAM0B,kBACN3C,WAAa,EACbiB,MAAM8B,oBAIJI,kBAAoB,KACN,IAAdnD,UACFT,gBAAgB0B,MAAMC,QAEtBD,MAAM0B,kBACN3C,WAAa,EACbiB,MAAM8B,oBAIVhD,WAAWiD,iBAAiB,SAAS,KATjB,IAAdhD,UACFT,gBAAgB0B,MAAMC,QAEtBD,MAAM0B,kBACN3C,WAAa,EACbiB,MAAM8B,sBAKVnD,WAAWoD,iBAAiB,SAAS,KAzBnC/B,MAAMe,mBAEFhC,YAAciB,MAAMA,MAAMiC,OAAS,GACrCxD,cACAuB,MAAM0B,kBACNrD,YAAY2B,MAAMG,mBAClBpB,UAAY,IAEZiB,MAAM0B,kBACN3C,WAAa,EACbiB,MAAM8B,8BAiBF9B,MAAOJ","file":"step.min.js","sourcesContent":["import { DATA } from './data.min.js';\nimport { showEndGame } from './end.min.js';\nimport { backToElections } from './elections.min.js';\nimport { addClassHidden, removeClassHidden } from './util.min.js';\nimport { hideOptions } from './options.min.js';\nimport { playSoundBubble } from './sound.min.js';\n\nconst buttonNext = document.querySelector('.options__button--next');\nconst buttonBack = document.querySelector('.options__button--back');\n\nlet indexStep = 0;\n\nconst renderStepAnswer = (image, indexImage, numbers, isRounded) => (`\n  <label class=\"step__item\">\n    <input class=\"step__radio visually-hidden\" type=\"radio\" value=\"${indexImage + 1}\" name=\"${numbers[0]}-${numbers[1]}\">\n    <picture>\n      <source srcset=\"img/items/${image}.webp 1x, img/items/${image}@2x.webp 2x\">\n      <img class=\"step__image ${isRounded ? 'step__image--rounded' : ''}\" src=\"img/items/${image}.png\" srcset=\"img/items/${image}@2x.png 2x\" width=\"300\" height=\"300\" alt=\"\" draggable=\"false\">\n    </picture>\n    <div class=\"step__check-mark\"></div>\n  </label>\n`)\n\nconst renderStepAnswers = (dataStep, numbers) => {\n  const {images, isRounded} = dataStep;\n  const answersMarkup = images.map((image, indexImage) => renderStepAnswer(image, indexImage, numbers, isRounded));\n\n  return (`\n    <fieldset class=\"step__list\">\n      ${answersMarkup.join('\\n')}\n    </fieldset>\n  `)\n}\n\nconst renderStep = (dataStep, numbers) => {\n  const {title} = dataStep;\n\n  return (`\n    <li class=\"level__step step step--hidden container\" data-class=\"step\">\n      <header class=\"step__header\">\n        <h2 class=\"step__title title title--step\">${title}</h2>\n      </header>\n        ${renderStepAnswers(dataStep, numbers)}\n    </li>\n  `)\n}\n\nconst renderStepsOfLevel = (levelIndex) => {\n  const stepsOfLevel = DATA.STEPS[levelIndex];\n  return stepsOfLevel.map((dataStep, number) => renderStep(dataStep, [levelIndex, number]));\n}\n\nconst steps = {\n  level: null, // get from level.js\n  rightAnswers: null, // get from level.js\n  givenRightAnswers: null, // get from level.js\n\n  getCurrentStep () {\n    this.steps = this.level.querySelectorAll('.step');\n    return this.steps[indexStep];\n  },\n\n  getDataOfAnswer(element) {\n    const stepItem = element.closest('.step__item');\n    const stepItemImageSrc = stepItem.querySelector('.step__image').src;\n    const stepTitleText = this.currentStep.querySelector('.step__title').textContent;\n    const answerData = {\n      image: stepItemImageSrc,\n      title: stepTitleText,\n    };\n\n    return answerData;\n  },\n\n  getCheckedAnswer() {\n    return this.stepList.querySelector('input:checked');\n  },\n\n  checkAnswer() {\n    this.givenAnswerOfStep = this.getCheckedAnswer();\n    const rightAnswerOfStep = this.rightAnswers[indexStep];\n    const givenAnswerOfStepValue = Number(this.givenAnswerOfStep.value);\n\n    if (rightAnswerOfStep === givenAnswerOfStepValue) {\n      const dataOfAnswer = this.getDataOfAnswer(this.givenAnswerOfStep);\n      this.givenRightAnswers.push(dataOfAnswer);\n    }\n  },\n\n  onStepListChange () {\n    buttonNext.classList.remove('button--hidden');\n    playSoundBubble();\n  },\n\n  clearStepListChange () {\n    this.stepList.removeEventListener('change', this.onStepListChange);\n  },\n\n  hideCurrentStep () {\n    const checkedAnswer = this.getCheckedAnswer();\n\n    if(checkedAnswer) {\n      checkedAnswer.checked = false;\n    }\n\n    buttonNext.classList.add('button--hidden');\n\n    this.clearStepListChange ()\n    addClassHidden(this.currentStep);\n  },\n\n  showCurrentStep () {\n    this.currentStep = this.getCurrentStep();\n    this.stepList = this.currentStep.querySelector('.step__list');\n\n    removeClassHidden(this.currentStep);\n    this.stepList.addEventListener('change', this.onStepListChange);\n  },\n};\n\nconst onButtonNextClick = () => {\n  steps.checkAnswer();\n\n  if (indexStep === steps.steps.length - 1) {\n    hideOptions();\n    steps.hideCurrentStep();\n    showEndGame(steps.givenRightAnswers);\n    indexStep = 0;\n  } else {\n    steps.hideCurrentStep();\n    indexStep += 1;\n    steps.showCurrentStep();\n  }\n};\n\nconst onButtonBackClick = () => {\n  if (indexStep === 0) {\n    backToElections(steps.level);\n  } else {\n    steps.hideCurrentStep();\n    indexStep -= 1;\n    steps.showCurrentStep();\n  }\n};\n\nbuttonBack.addEventListener('click', () => onButtonBackClick());\nbuttonNext.addEventListener('click', () => onButtonNextClick());\n\nexport {steps, renderStepsOfLevel};\n"]}